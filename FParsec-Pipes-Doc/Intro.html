<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- 
      The FParsec-Pipes: making FParsec parsers even more concise and consistent.
 parameters will be replaced with the 
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>FParsec-Pipes: making FParsec parsers even more concise and consistent.
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{page-description}">
    <meta name="author" content="{page-author}">
    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="style.css" />
    <script src="tips.js" type="text/javascript"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="https://github.com/rspeele/FParsec-Pipes">github page</a></li>
        </ul>
        <h3 class="muted">FParsec-Pipes</h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          <h1>FParsec-Pipes: making FParsec parsers even more concise and consistent.</h1>

<p><a href="http://www.quanttec.com/fparsec/">FParsec</a> is an F# library for writing parsers.
This library extends FParsec with a new set of combinators, which
I believe make it even easier to translate from a formal grammar like
<a href="https://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form">EBNF</a>
to F# parsing code and end up with a fast, highly readable parser.</p>

<h2>Show me an example</h2>

<p>Here's a parser for ISO-8601-formatted datetimes.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Parses `count` digits and returns the result as an integer.</span>
<span class="k">let</span> <span class="i">digits</span> (<span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">count</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="t">int</span>) <span class="o">=</span>
    <span class="o">%%</span> <span class="o">+.</span>(<span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="i">count</span>, <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="f">digit</span>)
    <span class="o">-%&gt;</span> (<span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="i">String</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="t">Int32</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="f">Parse</span>)

<span class="c">// Parses a yyyy-mm-dd date and returns the result as a tuple of 3 integers.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="f">date</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">4</span> <span class="o">--</span> <span class="s">&#39;-&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;-&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span>
    <span class="o">-%&gt;</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="i">auto</span>

<span class="c">// Parses a hh:mm:ss time and returns the result as a tuple of 3 integers.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 14)" onmouseover="showTip(event, 'fs12', 14)" class="f">time</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span>
    <span class="o">-%&gt;</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="i">auto</span>

<span class="c">// Parses a DateTime in the format yyyy-mm-ddThh:mm:ss</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="f">datetime</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="t">Parser</span><span class="o">&lt;</span>_, <span onmouseout="hideTip(event, 'fs15', 18)" onmouseover="showTip(event, 'fs15', 18)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs10', 19)" onmouseover="showTip(event, 'fs10', 19)" class="f">date</span> <span class="o">--</span> <span class="s">&#39;T&#39;</span> <span class="o">--</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs12', 20)" onmouseover="showTip(event, 'fs12', 20)" class="f">time</span>
    <span class="o">-%&gt;</span> <span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="i">yyyy</span>, <span onmouseout="hideTip(event, 'fs17', 22)" onmouseover="showTip(event, 'fs17', 22)" class="i">mm</span>, <span onmouseout="hideTip(event, 'fs18', 23)" onmouseover="showTip(event, 'fs18', 23)" class="i">dd</span>) (<span onmouseout="hideTip(event, 'fs19', 24)" onmouseover="showTip(event, 'fs19', 24)" class="i">hh</span>, <span onmouseout="hideTip(event, 'fs20', 25)" onmouseover="showTip(event, 'fs20', 25)" class="i">mi</span>, <span onmouseout="hideTip(event, 'fs21', 26)" onmouseover="showTip(event, 'fs21', 26)" class="i">ss</span>) <span class="k">-&gt;</span>
        <span class="k">new</span> <span onmouseout="hideTip(event, 'fs22', 27)" onmouseover="showTip(event, 'fs22', 27)" class="t">DateTime</span>(<span onmouseout="hideTip(event, 'fs16', 28)" onmouseover="showTip(event, 'fs16', 28)" class="i">yyyy</span>, <span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="i">mm</span>, <span onmouseout="hideTip(event, 'fs18', 30)" onmouseover="showTip(event, 'fs18', 30)" class="i">dd</span>, <span onmouseout="hideTip(event, 'fs19', 31)" onmouseover="showTip(event, 'fs19', 31)" class="i">hh</span>, <span onmouseout="hideTip(event, 'fs20', 32)" onmouseover="showTip(event, 'fs20', 32)" class="i">mi</span>, <span onmouseout="hideTip(event, 'fs21', 33)" onmouseover="showTip(event, 'fs21', 33)" class="i">ss</span>)
</code></pre>

<h2>What are the features?</h2>

<h3>Default parsers for values</h3>

<p>The unary operator <code>%</code> can be used to convert various values to the "obvious" corresponding parser.
This cuts down on clutter from explicitly using <code>pstring</code>, <code>pchar</code>, and others.
See the examples below:</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Expression:              // Equivalent to:</span>
<span class="o">%</span><span class="s">&quot;bob&quot;</span>                      <span class="c">// pstring &quot;bob&quot;</span>
<span class="o">%</span><span onmouseout="hideTip(event, 'fs23', 34)" onmouseover="showTip(event, 'fs23', 34)" class="f">ci</span> <span class="s">&quot;jim&quot;</span>                   <span class="c">// pstringCI &quot;jim&quot; // case insensitive</span>
<span class="o">%</span><span class="s">&#39;b&#39;</span>                        <span class="c">// pchar &#39;b&#39;</span>
<span class="o">%</span><span onmouseout="hideTip(event, 'fs23', 35)" onmouseover="showTip(event, 'fs23', 35)" class="f">ci</span> <span class="s">&#39;b&#39;</span>                     <span class="c">// pcharCI &#39;b&#39; // case insensitive</span>
<span class="o">%</span>[<span class="s">&#39;a&#39;</span>; <span class="s">&#39;b&#39;</span>]                 <span class="c">// choice [pchar &#39;a&#39;; pchar &#39;b&#39;]</span>
<span class="o">%</span>[<span class="s">&quot;alice&quot;</span>; <span class="s">&quot;bob&quot;</span>]           <span class="c">// choice [pstring &quot;alice&quot;; pstring &quot;bob&quot;]</span>
<span class="o">%</span>[<span onmouseout="hideTip(event, 'fs24', 36)" onmouseover="showTip(event, 'fs24', 36)" class="f">pint32</span>; <span onmouseout="hideTip(event, 'fs25', 37)" onmouseover="showTip(event, 'fs25', 37)" class="f">preturn</span> (<span class="o">-</span><span class="n">1</span>)]     <span class="c">// choice [pint32; preturn (-1)]</span>
</code></pre>

<p>The value you pass to <code>%</code> can also be of type <code>DefaultParserOf&lt;'a&gt;</code>, which you
can obtain by using <code>p&lt;'a&gt;</code>. If <code>'a</code> is a supported type, the resulting
parser will be one to parse any <code>'a</code>.</p>

<p>This works for several primitive types, including all integer types.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Expression:  // Equivalent to:</span>
<span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 38)" onmouseover="showTip(event, 'fs26', 38)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs5', 39)" onmouseover="showTip(event, 'fs5', 39)" class="t">int</span><span class="o">&gt;</span>         <span class="c">// pint32</span>
<span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 40)" onmouseover="showTip(event, 'fs26', 40)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs27', 41)" onmouseover="showTip(event, 'fs27', 41)" class="t">uint16</span><span class="o">&gt;</span>      <span class="c">// puint16</span>
<span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 42)" onmouseover="showTip(event, 'fs26', 42)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 43)" onmouseover="showTip(event, 'fs28', 43)" class="t">float</span><span class="o">&gt;</span>       <span class="c">// pfloat</span>
<span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 44)" onmouseover="showTip(event, 'fs26', 44)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs29', 45)" onmouseover="showTip(event, 'fs29', 45)" class="t">Position</span><span class="o">&gt;</span>    <span class="c">// getPosition</span>
</code></pre>

<p>You can make <code>p</code> work for your own types, too. Simply define:</p>

<p><code>static member DefaultParser : Parser&lt;'a, 'u&gt;</code></p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs30', 46)" onmouseover="showTip(event, 'fs30', 46)" class="t">Vector3D</span> <span class="o">=</span>
    {
        <span onmouseout="hideTip(event, 'fs31', 47)" onmouseover="showTip(event, 'fs31', 47)" class="i">X</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 48)" onmouseover="showTip(event, 'fs28', 48)" class="t">float</span>
        <span onmouseout="hideTip(event, 'fs32', 49)" onmouseover="showTip(event, 'fs32', 49)" class="i">Y</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 50)" onmouseover="showTip(event, 'fs28', 50)" class="t">float</span>
        <span onmouseout="hideTip(event, 'fs33', 51)" onmouseover="showTip(event, 'fs33', 51)" class="i">Z</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 52)" onmouseover="showTip(event, 'fs28', 52)" class="t">float</span>
    }
    <span class="c">// Parses a vector in the format (x, y, z)</span>
    <span class="k">static</span> <span class="k">member</span> <span onmouseout="hideTip(event, 'fs34', 53)" onmouseover="showTip(event, 'fs34', 53)" class="i">DefaultParser</span> <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs35', 54)" onmouseover="showTip(event, 'fs35', 54)" class="f">comma</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs36', 55)" onmouseover="showTip(event, 'fs36', 55)" class="f">spaces</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">.</span> <span class="o">%</span><span class="s">&#39;,&#39;</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">.</span> <span onmouseout="hideTip(event, 'fs36', 56)" onmouseover="showTip(event, 'fs36', 56)" class="f">spaces</span>
        <span onmouseout="hideTip(event, 'fs37', 57)" onmouseover="showTip(event, 'fs37', 57)" class="f">pipe3</span>
            (<span class="o">%</span><span class="s">&#39;(&#39;</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">.</span> <span onmouseout="hideTip(event, 'fs36', 58)" onmouseover="showTip(event, 'fs36', 58)" class="f">spaces</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">.</span> <span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 59)" onmouseover="showTip(event, 'fs26', 59)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 60)" onmouseover="showTip(event, 'fs28', 60)" class="t">float</span><span class="o">&gt;</span>)
            (<span onmouseout="hideTip(event, 'fs35', 61)" onmouseover="showTip(event, 'fs35', 61)" class="f">comma</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">.</span> <span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 62)" onmouseover="showTip(event, 'fs26', 62)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 63)" onmouseover="showTip(event, 'fs28', 63)" class="t">float</span><span class="o">&gt;</span>)
            (<span onmouseout="hideTip(event, 'fs35', 64)" onmouseover="showTip(event, 'fs35', 64)" class="f">comma</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">.</span> <span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 65)" onmouseover="showTip(event, 'fs26', 65)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 66)" onmouseover="showTip(event, 'fs28', 66)" class="t">float</span><span class="o">&gt;</span> <span class="o">.</span><span class="o">&gt;&gt;</span> <span onmouseout="hideTip(event, 'fs36', 67)" onmouseover="showTip(event, 'fs36', 67)" class="f">spaces</span> <span class="o">.</span><span class="o">&gt;&gt;</span> <span class="o">%</span><span class="s">&#39;)&#39;</span>)
            (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs38', 68)" onmouseover="showTip(event, 'fs38', 68)" class="i">x</span> <span onmouseout="hideTip(event, 'fs39', 69)" onmouseover="showTip(event, 'fs39', 69)" class="i">y</span> <span onmouseout="hideTip(event, 'fs40', 70)" onmouseover="showTip(event, 'fs40', 70)" class="i">z</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs31', 71)" onmouseover="showTip(event, 'fs31', 71)" class="i">X</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 72)" onmouseover="showTip(event, 'fs38', 72)" class="i">x</span>; <span onmouseout="hideTip(event, 'fs32', 73)" onmouseover="showTip(event, 'fs32', 73)" class="i">Y</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 74)" onmouseover="showTip(event, 'fs39', 74)" class="i">y</span>; <span onmouseout="hideTip(event, 'fs33', 75)" onmouseover="showTip(event, 'fs33', 75)" class="i">Z</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs40', 76)" onmouseover="showTip(event, 'fs40', 76)" class="i">z</span> })

<span class="o">%</span><span onmouseout="hideTip(event, 'fs26', 77)" onmouseover="showTip(event, 'fs26', 77)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs30', 78)" onmouseover="showTip(event, 'fs30', 78)" class="t">Vector3D</span><span class="o">&gt;</span> <span class="c">// equivalent to Vector3D.DefaultParser</span>
</code></pre>

<h3>Pipes</h3>

<p>Notice that the above <code>DefaultParser</code> example used the function <code>pipe3</code>, and the combinators <code>&gt;&gt;.</code> and <code>.&gt;&gt;</code>.
Using vanilla FParsec, when you want to make a parser like "<code>parserA</code> followed by <code>parserB</code> followed by <code>parserC</code>",
you must choose between <code>&gt;&gt;.</code>, <code>.&gt;&gt;</code>, <code>.&gt;&gt;.</code>, <code>pipe2</code> through <code>pipe5</code>, or <code>tuple2</code> through <code>tuple5</code>, depending on which
of the chained parsers you want to consume the output of.</p>

<p>This means that two parsers written to consume the same grammar may look quite different, if their authors
had different requirements about how much information to capture in their output <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a>.
A "recognizer" that simply validates the source passed to it will have a very different structure from a parser that produces an AST.</p>

<p>FParsec-Pipes replaces all such sequencing combinators with "pipes", so named because they fill the purpose of the <code>pipe2</code> family of operators.
The rules for combining parsers with these operators are simple:</p>

<ul>
<li>Start the pipe with <code>%%</code> followed by the first parser.</li>
<li>Add additional parsers to the pipe with the <code>--</code> operator.</li>
<li>"Capture" parser outputs in the pipe with the <code>+.</code> prefix operator.</li>
<li>Complete the pipe with <code>-%&gt;</code> by supplying a function to combine all the "captured" outputs.</li>
</ul>

<p>All the operators use <code>%</code> to convert their operands to parsers, so you can use raw characters and strings
in the pipeline. Here's the rewritten version of the <code>Vector3D</code> parser.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs41', 79)" onmouseover="showTip(event, 'fs41', 79)" class="f">vector3pipe</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 80)" onmouseover="showTip(event, 'fs14', 80)" class="t">Parser</span><span class="o">&lt;</span>_, <span onmouseout="hideTip(event, 'fs15', 81)" onmouseover="showTip(event, 'fs15', 81)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="s">&#39;(&#39;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 82)" onmouseover="showTip(event, 'fs36', 82)" class="f">spaces</span>
    <span class="o">--</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs26', 83)" onmouseover="showTip(event, 'fs26', 83)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 84)" onmouseover="showTip(event, 'fs28', 84)" class="t">float</span><span class="o">&gt;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 85)" onmouseover="showTip(event, 'fs36', 85)" class="f">spaces</span> <span class="o">--</span> <span class="s">&#39;,&#39;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 86)" onmouseover="showTip(event, 'fs36', 86)" class="f">spaces</span>
    <span class="o">--</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs26', 87)" onmouseover="showTip(event, 'fs26', 87)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 88)" onmouseover="showTip(event, 'fs28', 88)" class="t">float</span><span class="o">&gt;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 89)" onmouseover="showTip(event, 'fs36', 89)" class="f">spaces</span> <span class="o">--</span> <span class="s">&#39;,&#39;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 90)" onmouseover="showTip(event, 'fs36', 90)" class="f">spaces</span>
    <span class="o">--</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs26', 91)" onmouseover="showTip(event, 'fs26', 91)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 92)" onmouseover="showTip(event, 'fs28', 92)" class="t">float</span><span class="o">&gt;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 93)" onmouseover="showTip(event, 'fs36', 93)" class="f">spaces</span> <span class="o">--</span> <span class="s">&#39;)&#39;</span>
    <span class="o">-%&gt;</span> <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs38', 94)" onmouseover="showTip(event, 'fs38', 94)" class="i">x</span> <span onmouseout="hideTip(event, 'fs39', 95)" onmouseover="showTip(event, 'fs39', 95)" class="i">y</span> <span onmouseout="hideTip(event, 'fs40', 96)" onmouseover="showTip(event, 'fs40', 96)" class="i">z</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs31', 97)" onmouseover="showTip(event, 'fs31', 97)" class="i">X</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 98)" onmouseover="showTip(event, 'fs38', 98)" class="i">x</span>; <span onmouseout="hideTip(event, 'fs32', 99)" onmouseover="showTip(event, 'fs32', 99)" class="i">Y</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs39', 100)" onmouseover="showTip(event, 'fs39', 100)" class="i">y</span>; <span onmouseout="hideTip(event, 'fs33', 101)" onmouseover="showTip(event, 'fs33', 101)" class="i">Z</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs40', 102)" onmouseover="showTip(event, 'fs40', 102)" class="i">z</span> }
</code></pre>

<p>Sometimes it's overkill to write a function to combine the captured outputs of a pipe.
Maybe the pipe has no outputs, or only one, or you just need a tuple.</p>

<p>For pipes with no outputs, you can give any value to <code>-%&gt;</code> and that value will be returned from the parser on success.
This is like the <code>&gt;&gt;%</code> operator in FParsec.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs42', 103)" onmouseover="showTip(event, 'fs42', 103)" class="f">unitexample</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 104)" onmouseover="showTip(event, 'fs14', 104)" class="t">Parser</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs15', 105)" onmouseover="showTip(event, 'fs15', 105)" class="t">unit</span>, <span onmouseout="hideTip(event, 'fs15', 106)" onmouseover="showTip(event, 'fs15', 106)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="s">&quot;this pipe&quot;</span> <span class="o">--</span> <span class="s">&quot;has no&quot;</span> <span class="o">--</span> <span class="s">&quot;captures&quot;</span> <span class="o">-%&gt;</span> ()

<span class="c">// Always produces the value 1337 on success</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 107)" onmouseover="showTip(event, 'fs43', 107)" class="f">constexample</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 108)" onmouseover="showTip(event, 'fs14', 108)" class="t">Parser</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs5', 109)" onmouseover="showTip(event, 'fs5', 109)" class="t">int</span>, <span onmouseout="hideTip(event, 'fs15', 110)" onmouseover="showTip(event, 'fs15', 110)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="s">&quot;some text&quot;</span> <span class="o">-%&gt;</span> <span class="n">1337</span>
</code></pre>

<p>For pipes with 1 to 5 outputs, you can automatically combine them into a tuple by using
<code>auto</code> as the terminating value.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Parses an int</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 111)" onmouseover="showTip(event, 'fs44', 111)" class="f">auto1example</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 112)" onmouseover="showTip(event, 'fs14', 112)" class="t">Parser</span><span class="o">&lt;</span>_, <span onmouseout="hideTip(event, 'fs15', 113)" onmouseover="showTip(event, 'fs15', 113)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="s">&quot;this pipe&quot;</span> <span class="o">--</span> <span class="s">&quot;has one&quot;</span> <span class="o">--</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs26', 114)" onmouseover="showTip(event, 'fs26', 114)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs5', 115)" onmouseover="showTip(event, 'fs5', 115)" class="t">int</span><span class="o">&gt;</span> <span class="o">--</span> <span class="s">&quot;capture&quot;</span>
    <span class="o">-%&gt;</span> <span onmouseout="hideTip(event, 'fs11', 116)" onmouseover="showTip(event, 'fs11', 116)" class="i">auto</span>

<span class="c">// Parse a tuple (float, int)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 117)" onmouseover="showTip(event, 'fs45', 117)" class="f">auto2example</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 118)" onmouseover="showTip(event, 'fs14', 118)" class="t">Parser</span><span class="o">&lt;</span>_, <span onmouseout="hideTip(event, 'fs15', 119)" onmouseover="showTip(event, 'fs15', 119)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="o">%%</span> <span class="s">&quot;this pipe&quot;</span> <span class="o">--</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs26', 120)" onmouseover="showTip(event, 'fs26', 120)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 121)" onmouseover="showTip(event, 'fs28', 121)" class="t">float</span><span class="o">&gt;</span> <span class="o">--</span> <span class="s">&quot;has two&quot;</span> <span class="o">--</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs26', 122)" onmouseover="showTip(event, 'fs26', 122)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs5', 123)" onmouseover="showTip(event, 'fs5', 123)" class="t">int</span><span class="o">&gt;</span> <span class="o">--</span> <span class="s">&quot;captures&quot;</span>
    <span class="o">-%&gt;</span> <span onmouseout="hideTip(event, 'fs11', 124)" onmouseover="showTip(event, 'fs11', 124)" class="i">auto</span>
</code></pre>

<h3>Backtracking with pipes</h3>

<p>Sometimes it is necessary to backtrack in a parser.
For example, suppose that at a given place in a file format, it is valid to find either
a date/time in ISO 8601 format, or a Unix timestamp as a 64-bit integer.</p>

<p>Here is one attempt at this:</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs46', 125)" onmouseover="showTip(event, 'fs46', 125)" class="t">Timestamp</span> <span class="o">=</span>
    | <span onmouseout="hideTip(event, 'fs47', 126)" onmouseover="showTip(event, 'fs47', 126)" class="p">UnixTimestamp</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs48', 127)" onmouseover="showTip(event, 'fs48', 127)" class="t">int64</span>
    | <span onmouseout="hideTip(event, 'fs49', 128)" onmouseover="showTip(event, 'fs49', 128)" class="p">CalendarTimestamp</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs22', 129)" onmouseover="showTip(event, 'fs22', 129)" class="t">DateTime</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 130)" onmouseover="showTip(event, 'fs50', 130)" class="f">unixTimestamp</span> <span class="o">=</span> <span class="o">%%</span> <span class="o">+.</span><span onmouseout="hideTip(event, 'fs26', 131)" onmouseover="showTip(event, 'fs26', 131)" class="i">p</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs48', 132)" onmouseover="showTip(event, 'fs48', 132)" class="t">int64</span><span class="o">&gt;</span> <span class="o">-%&gt;</span> <span onmouseout="hideTip(event, 'fs47', 133)" onmouseover="showTip(event, 'fs47', 133)" class="p">UnixTimestamp</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 134)" onmouseover="showTip(event, 'fs51', 134)" class="f">calendarTimestamp</span> <span class="o">=</span>
    <span class="k">let</span> <span class="i">digits</span> (<span onmouseout="hideTip(event, 'fs4', 135)" onmouseover="showTip(event, 'fs4', 135)" class="i">count</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 136)" onmouseover="showTip(event, 'fs5', 136)" class="t">int</span>) <span class="o">=</span> <span class="o">%%</span> <span class="o">+.</span>(<span onmouseout="hideTip(event, 'fs4', 137)" onmouseover="showTip(event, 'fs4', 137)" class="i">count</span>, <span onmouseout="hideTip(event, 'fs6', 138)" onmouseover="showTip(event, 'fs6', 138)" class="f">digit</span>) <span class="o">-%&gt;</span> (<span onmouseout="hideTip(event, 'fs7', 139)" onmouseover="showTip(event, 'fs7', 139)" class="i">String</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs8', 140)" onmouseover="showTip(event, 'fs8', 140)" class="t">Int32</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 141)" onmouseover="showTip(event, 'fs9', 141)" class="f">Parse</span>)
    <span class="o">%%</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">4</span> <span class="o">--</span> <span class="s">&#39;-&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;-&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;T&#39;</span>
    <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span>
    <span class="o">-%&gt;</span> <span class="k">fun</span> <span class="i">yyyy</span> <span class="i">mm</span> <span class="i">dd</span> <span class="i">h</span> <span class="i">m</span> <span class="i">s</span> <span class="k">-&gt;</span>
        <span class="k">new</span> <span onmouseout="hideTip(event, 'fs22', 142)" onmouseover="showTip(event, 'fs22', 142)" class="i">DateTime</span>(<span class="i">yyyy</span>, <span class="i">mm</span>, <span class="i">dd</span>, <span class="i">h</span>, <span class="i">m</span>, <span class="i">s</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs49', 143)" onmouseover="showTip(event, 'fs49', 143)" class="i">CalendarTimestamp</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 144)" onmouseover="showTip(event, 'fs52', 144)" class="f">timestamp</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 145)" onmouseover="showTip(event, 'fs14', 145)" class="t">Parser</span><span class="o">&lt;</span>_, <span onmouseout="hideTip(event, 'fs15', 146)" onmouseover="showTip(event, 'fs15', 146)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="o">%</span>[<span onmouseout="hideTip(event, 'fs51', 147)" onmouseover="showTip(event, 'fs51', 147)" class="f">calendarTimestamp</span>; <span onmouseout="hideTip(event, 'fs50', 148)" onmouseover="showTip(event, 'fs50', 148)" class="f">unixTimestamp</span>]
</code></pre>

<p>The problem with this approach is that, given the Unix timestamp input <code>1458730894</code>,
the first part of <code>calendarTimestamp</code> will succeed since it successfully parses 4 digits.
It will fail when it encounters <code>7</code> as the next character instead of the expected <code>-</code>,
but since it's already consumed input and advanced the parser state, the alternative
<code>unixTimestamp</code> parser will not be attempted.</p>

<p>The solution is to add backtracking to <code>calendarTimestamp</code>. What we want is to ensure that,
until we've seen the first <code>-</code>, the whole pipe can be backtracked to the beginning.</p>

<p>Vanilla FParsec provides the <code>attempt</code>, <code>&gt;&gt;?</code>, <code>.&gt;&gt;?</code>, and <code>.&gt;&gt;.?</code> combinators for this type of situation.
However, there's no need to abandon the pipe syntax -- it supports backtracking too, with the <code>?-</code> and <code>-?</code> operators.</p>

<p>The <code>?-</code> operator wraps everything to its left in <code>attempt</code>.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs53', 149)" onmouseover="showTip(event, 'fs53', 149)" class="f">calendarTimestampBacktrack1</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 150)" onmouseover="showTip(event, 'fs14', 150)" class="t">Parser</span><span class="o">&lt;</span>_, <span onmouseout="hideTip(event, 'fs15', 151)" onmouseover="showTip(event, 'fs15', 151)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="k">let</span> <span class="i">digits</span> (<span onmouseout="hideTip(event, 'fs4', 152)" onmouseover="showTip(event, 'fs4', 152)" class="i">count</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 153)" onmouseover="showTip(event, 'fs5', 153)" class="t">int</span>) <span class="o">=</span> <span class="o">%%</span> <span class="o">+.</span>(<span onmouseout="hideTip(event, 'fs4', 154)" onmouseover="showTip(event, 'fs4', 154)" class="i">count</span>, <span onmouseout="hideTip(event, 'fs6', 155)" onmouseover="showTip(event, 'fs6', 155)" class="f">digit</span>) <span class="o">-%&gt;</span> (<span onmouseout="hideTip(event, 'fs7', 156)" onmouseover="showTip(event, 'fs7', 156)" class="i">String</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs8', 157)" onmouseover="showTip(event, 'fs8', 157)" class="t">Int32</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 158)" onmouseover="showTip(event, 'fs9', 158)" class="f">Parse</span>)
    <span class="o">%%</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">4</span> <span class="o">--</span> <span class="s">&#39;-&#39;</span> <span class="o">?-</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;-&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;T&#39;</span>
                      <span class="c">// ^^ Backtrack the whole pipe if anything to the left of this fails.</span>
    <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span>
    <span class="o">-%&gt;</span> <span class="k">fun</span> <span class="i">yyyy</span> <span class="i">mm</span> <span class="i">dd</span> <span class="i">h</span> <span class="i">m</span> <span class="i">s</span> <span class="k">-&gt;</span>
        <span class="k">new</span> <span onmouseout="hideTip(event, 'fs22', 159)" onmouseover="showTip(event, 'fs22', 159)" class="i">DateTime</span>(<span class="i">yyyy</span>, <span class="i">mm</span>, <span class="i">dd</span>, <span class="i">h</span>, <span class="i">m</span>, <span class="i">s</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs49', 160)" onmouseover="showTip(event, 'fs49', 160)" class="i">CalendarTimestamp</span>
</code></pre>

<p>The <code>-?</code> also wraps everything to its left in <code>attempt</code>, but also joins its left and right
together using <code>.&gt;&gt;.?</code>, so that if the right side fails <em>without changing the parser state</em>,
the pipe will backtrack to the beginning.</p>

<p>This is a bit harder to understand, but can sometimes produce better error messages.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 161)" onmouseover="showTip(event, 'fs54', 161)" class="f">calendarTimestampBacktrack2</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 162)" onmouseover="showTip(event, 'fs14', 162)" class="t">Parser</span><span class="o">&lt;</span>_, <span onmouseout="hideTip(event, 'fs15', 163)" onmouseover="showTip(event, 'fs15', 163)" class="t">unit</span><span class="o">&gt;</span> <span class="o">=</span>
    <span class="k">let</span> <span class="i">digits</span> (<span onmouseout="hideTip(event, 'fs4', 164)" onmouseover="showTip(event, 'fs4', 164)" class="i">count</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 165)" onmouseover="showTip(event, 'fs5', 165)" class="t">int</span>) <span class="o">=</span> <span class="o">%%</span> <span class="o">+.</span>(<span onmouseout="hideTip(event, 'fs4', 166)" onmouseover="showTip(event, 'fs4', 166)" class="i">count</span>, <span onmouseout="hideTip(event, 'fs6', 167)" onmouseover="showTip(event, 'fs6', 167)" class="f">digit</span>) <span class="o">-%&gt;</span> (<span onmouseout="hideTip(event, 'fs7', 168)" onmouseover="showTip(event, 'fs7', 168)" class="i">String</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs8', 169)" onmouseover="showTip(event, 'fs8', 169)" class="t">Int32</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 170)" onmouseover="showTip(event, 'fs9', 170)" class="f">Parse</span>)
    <span class="o">%%</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">4</span> <span class="o">-?</span> <span class="s">&#39;-&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;-&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;T&#39;</span>
                  <span class="c">// ^^ Backtrack the whole pipe if anything to the left of this fails,</span>
                  <span class="c">// or if the parser to the right fails without changing the parser state.</span>
    <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span> <span class="o">--</span> <span class="s">&#39;:&#39;</span> <span class="o">--</span> <span class="o">+.</span><span class="i">digits</span> <span class="n">2</span>
    <span class="o">-%&gt;</span> <span class="k">fun</span> <span class="i">yyyy</span> <span class="i">mm</span> <span class="i">dd</span> <span class="i">h</span> <span class="i">m</span> <span class="i">s</span> <span class="k">-&gt;</span>
        <span class="k">new</span> <span onmouseout="hideTip(event, 'fs22', 171)" onmouseover="showTip(event, 'fs22', 171)" class="i">DateTime</span>(<span class="i">yyyy</span>, <span class="i">mm</span>, <span class="i">dd</span>, <span class="i">h</span>, <span class="i">m</span>, <span class="i">s</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs49', 172)" onmouseover="showTip(event, 'fs49', 172)" class="i">CalendarTimestamp</span>
</code></pre>

<p>You can think of <code>?-</code> and <code>-?</code> as marking the end of ambiguity.</p>

<p><code>?-</code> says "if we've gotten this far, we're definitely looking at something that is <em>supposed</em> to
match this parser, and if it doesn't, that's a syntax error."</p>

<p><code>-?</code> is similar, but changes the condition to "if we've gotten this far, <em>and</em> the next little bit doesn't <em>immediately</em> look wrong".</p>

<h3>Repetition and separation</h3>

<p>FParsec includes many combinators for defining parsers like "zero or more of <code>parserA</code>" or
"one or more of <code>parserA</code> separated by <code>parserB</code>". These include <code>many</code>, <code>many1</code>, <code>sepBy</code>, and <code>sepEndBy</code>.</p>

<p>FParsec-Pipes uses F#'s slice notation to handle the concept of ranges.
You can slice into <code>qty</code> to get a <code>Range</code> object, and multiply a parser
(or a value that can be converted to a parser with <code>%</code>) by that range.</p>

<p>The resulting parser parses a <code>System.Collections.Generic.List</code> (not an F# list) of values.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="s">&#39;a&#39;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs55', 173)" onmouseover="showTip(event, 'fs55', 173)" class="i">qty</span><span class="o">.</span>[<span class="n">3</span>]    <span class="c">// parse exactly 3 &#39;a&#39;s   -- similar to `parray 3 %&#39;a&#39;`</span>
<span class="s">&#39;a&#39;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs55', 174)" onmouseover="showTip(event, 'fs55', 174)" class="i">qty</span><span class="o">.</span>[<span class="n">1..</span>]  <span class="c">// parse one or more &#39;a&#39;s -- similar to `many1 %&#39;a&#39;`</span>
<span class="s">&#39;a&#39;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs55', 175)" onmouseover="showTip(event, 'fs55', 175)" class="i">qty</span><span class="o">.</span>[<span class="n">0..</span>]  <span class="c">// parse 0 or more &#39;a&#39;s   -- similar to `many %&#39;a&#39;`</span>
<span class="s">&#39;a&#39;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs55', 176)" onmouseover="showTip(event, 'fs55', 176)" class="i">qty</span><span class="o">.</span>[<span class="o">..</span><span class="n">5</span>]  <span class="c">// parse up to 5 &#39;a&#39;s</span>
<span class="s">&#39;a&#39;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs55', 177)" onmouseover="showTip(event, 'fs55', 177)" class="i">qty</span><span class="o">.</span>[<span class="n">3..</span><span class="n">6</span>] <span class="c">// parse at least 3 and at most 6 &#39;a&#39;s</span>
<span onmouseout="hideTip(event, 'fs55', 178)" onmouseover="showTip(event, 'fs55', 178)" class="i">qty</span><span class="o">.</span>[<span class="n">3</span>] <span class="o">*</span> <span class="s">&#39;a&#39;</span>    <span class="c">// the range can be on either side of the *</span>
</code></pre>

<p>For separation, <code>/</code> is also overloaded on ranges.
Another variant, <code>/.</code>, allows (but does not require) a separator to appear after the last element.</p>

<p>Mathematically this is of course nonsense, but <code>/</code> was chosen because
you can say that the elements are "divided" by their separators, in the
same way that a fence divides pieces of property.</p>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="s">&#39;a&#39;</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs55', 179)" onmouseover="showTip(event, 'fs55', 179)" class="i">qty</span><span class="o">.</span>[<span class="n">0..</span>] <span class="o">/</span> <span class="s">&#39;,&#39;</span>) <span class="c">// parse 0 or more &#39;a&#39;s separated by &#39;,&#39;s</span>
                        <span class="c">// similar to sepBy %&#39;a&#39; %&#39;,&#39;</span>

<span onmouseout="hideTip(event, 'fs55', 180)" onmouseover="showTip(event, 'fs55', 180)" class="i">qty</span><span class="o">.</span>[<span class="n">0..</span>] <span class="o">/</span> <span class="s">&#39;,&#39;</span> <span class="o">*</span> <span class="s">&#39;a&#39;</span>   <span class="c">// same as above, just written in a different order</span>
                        <span class="c">// this may be preferable as it doesn&#39;t require parentheses</span>

<span onmouseout="hideTip(event, 'fs55', 181)" onmouseover="showTip(event, 'fs55', 181)" class="i">qty</span><span class="o">.</span>[<span class="n">1..</span>] <span class="o">/.</span> <span class="s">&#39;,&#39;</span> <span class="o">*</span> <span class="s">&#39;a&#39;</span>  <span class="c">// parse one or more &#39;a&#39;s separated by &#39;,&#39;s, with an optional trailing &#39;,&#39;</span>
                        <span class="c">// similar to sepEndBy1 %&#39;a&#39; %&#39;,&#39;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs56', 182)" onmouseover="showTip(event, 'fs56', 182)" class="f">comma</span>() <span class="o">=</span> <span class="o">%%</span> <span class="s">&quot;,&quot;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 183)" onmouseover="showTip(event, 'fs36', 183)" class="f">spaces</span> <span class="o">-%&gt;</span> ()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs57', 184)" onmouseover="showTip(event, 'fs57', 184)" class="f">element</span>() <span class="o">=</span> <span class="o">%%</span> <span class="s">&#39;a&#39;</span> <span class="o">--</span> <span onmouseout="hideTip(event, 'fs36', 185)" onmouseover="showTip(event, 'fs36', 185)" class="f">spaces</span> <span class="o">-%&gt;</span> ()
<span class="k">in</span> <span onmouseout="hideTip(event, 'fs55', 186)" onmouseover="showTip(event, 'fs55', 186)" class="i">qty</span><span class="o">.</span>[<span class="n">2..</span><span class="n">10</span>] <span class="o">/</span> <span onmouseout="hideTip(event, 'fs56', 187)" onmouseover="showTip(event, 'fs56', 187)" class="f">comma</span>() <span class="o">*</span> <span onmouseout="hideTip(event, 'fs57', 188)" onmouseover="showTip(event, 'fs57', 188)" class="f">element</span>() <span class="c">// parse 2 to 10 &#39;a&#39;s separated by commas, with whitespace allowed</span>
</code></pre>

          <div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace FParsec</div>
<div class="tip" id="fs3">namespace FParsec.Pipes</div>
<div class="tip" id="fs4">val count : int</div>
<div class="tip" id="fs5">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs6">val digit : Parser&lt;char,&#39;u&gt;<br /><br />Full name: FParsec.CharParsers.digit</div>
<div class="tip" id="fs7">Multiple items<br />type String =<br />&#160;&#160;new : value:char -&gt; string + 7 overloads<br />&#160;&#160;member Chars : int -&gt; char<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;member Contains : value:string -&gt; bool<br />&#160;&#160;member CopyTo : sourceIndex:int * destination:char[] * destinationIndex:int * count:int -&gt; unit<br />&#160;&#160;member EndsWith : value:string -&gt; bool + 2 overloads<br />&#160;&#160;member Equals : obj:obj -&gt; bool + 2 overloads<br />&#160;&#160;member GetEnumerator : unit -&gt; CharEnumerator<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;...<br /><br />Full name: System.String<br /><br />--------------------<br />String(value: nativeptr&lt;char&gt;) : unit<br />String(value: nativeptr&lt;sbyte&gt;) : unit<br />String(value: char []) : unit<br />String(c: char, count: int) : unit<br />String(value: nativeptr&lt;char&gt;, startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int) : unit<br />String(value: char [], startIndex: int, length: int) : unit<br />String(value: nativeptr&lt;sbyte&gt;, startIndex: int, length: int, enc: Text.Encoding) : unit</div>
<div class="tip" id="fs8">type Int32 =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;&#160;&#160;member Equals : obj:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member GetTypeCode : unit -&gt; TypeCode<br />&#160;&#160;&#160;&#160;member ToString : unit -&gt; string + 3 overloads<br />&#160;&#160;&#160;&#160;static val MaxValue : int<br />&#160;&#160;&#160;&#160;static val MinValue : int<br />&#160;&#160;&#160;&#160;static member Parse : s:string -&gt; int + 3 overloads<br />&#160;&#160;&#160;&#160;static member TryParse : s:string * result:int -&gt; bool + 1 overload<br />&#160;&#160;end<br /><br />Full name: System.Int32</div>
<div class="tip" id="fs9">Int32.Parse(s: string) : int<br />Int32.Parse(s: string, provider: IFormatProvider) : int<br />Int32.Parse(s: string, style: Globalization.NumberStyles) : int<br />Int32.Parse(s: string, style: Globalization.NumberStyles, provider: IFormatProvider) : int</div>
<div class="tip" id="fs10">val date : Parser&lt;(int * int * int),unit&gt;<br /><br />Full name: Intro.date</div>
<div class="tip" id="fs11">val auto : DefaultEnding<br /><br />Full name: FParsec.Pipes.Pipes.auto</div>
<div class="tip" id="fs12">val time : Parser&lt;(int * int * int),unit&gt;<br /><br />Full name: Intro.time</div>
<div class="tip" id="fs13">val datetime : Parser&lt;DateTime,unit&gt;<br /><br />Full name: Intro.datetime</div>
<div class="tip" id="fs14">type Parser&lt;&#39;Result,&#39;UserState&gt; = CharStream&lt;&#39;UserState&gt; -&gt; Reply&lt;&#39;Result&gt;<br /><br />Full name: FParsec.Primitives.Parser&lt;_,_&gt;</div>
<div class="tip" id="fs15">type unit = Unit<br /><br />Full name: Microsoft.FSharp.Core.unit</div>
<div class="tip" id="fs16">val yyyy : int</div>
<div class="tip" id="fs17">val mm : int</div>
<div class="tip" id="fs18">val dd : int</div>
<div class="tip" id="fs19">val hh : int</div>
<div class="tip" id="fs20">val mi : int</div>
<div class="tip" id="fs21">val ss : int</div>
<div class="tip" id="fs22">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs23">val ci : x:&#39;a -&gt; CaseInsensitive&lt;&#39;a&gt;<br /><br />Full name: FParsec.Pipes.DefaultParsers.ci</div>
<div class="tip" id="fs24">val pint32 : Parser&lt;int32,&#39;u&gt;<br /><br />Full name: FParsec.CharParsers.pint32</div>
<div class="tip" id="fs25">val preturn : &#39;a -&gt; Parser&lt;&#39;a,&#39;u&gt;<br /><br />Full name: FParsec.Primitives.preturn</div>
<div class="tip" id="fs26">val p&lt;&#39;a&gt; : DefaultParserOf&lt;&#39;a&gt;<br /><br />Full name: FParsec.Pipes.DefaultParsers.p</div>
<div class="tip" id="fs27">Multiple items<br />val uint16 : value:&#39;T -&gt; uint16 (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.uint16<br /><br />--------------------<br />type uint16 = UInt16<br /><br />Full name: Microsoft.FSharp.Core.uint16</div>
<div class="tip" id="fs28">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs29">Multiple items<br />type Position =<br />&#160;&#160;new : streamName:string * index:int64 * line:int64 * column:int64 -&gt; Position<br />&#160;&#160;member Column : int64 with get, set<br />&#160;&#160;member CompareTo : other:Position -&gt; int<br />&#160;&#160;member Equals : obj:obj -&gt; bool + 1 overload<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;member Index : int64 with get, set<br />&#160;&#160;member Line : int64 with get, set<br />&#160;&#160;member StreamName : string with get, set<br />&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;static member Compare : left:Position * right:Position -&gt; int<br /><br />Full name: FParsec.Position<br /><br />--------------------<br />Position(streamName: string, index: int64, line: int64, column: int64) : unit</div>
<div class="tip" id="fs30">type Vector3D =<br />&#160;&#160;{X: float;<br />&#160;&#160;&#160;Y: float;<br />&#160;&#160;&#160;Z: float;}<br />&#160;&#160;static member DefaultParser : Parser&lt;Vector3D,unit&gt;<br /><br />Full name: Intro.Vector3D</div>
<div class="tip" id="fs31">Vector3D.X: float</div>
<div class="tip" id="fs32">Vector3D.Y: float</div>
<div class="tip" id="fs33">Vector3D.Z: float</div>
<div class="tip" id="fs34">Multiple items<br />static member Vector3D.DefaultParser : Parser&lt;Vector3D,unit&gt;<br /><br />Full name: Intro.Vector3D.DefaultParser<br /><br />--------------------<br />type DefaultParser =<br />&#160;&#160;| DefaultParser<br />&#160;&#160;static member ( %!!~~% ) : DefaultParser:DefaultParser * list:&#39;a0 list -&gt; (CharStream&lt;&#39;a2&gt; -&gt; Reply&lt;&#39;a1&gt;) (requires member ( %!!~~% ))<br />&#160;&#160;static member ( %!!~~% ) : DefaultParser:DefaultParser * literal:string -&gt; Parser&lt;string,&#39;a0&gt;<br />&#160;&#160;static member ( %!!~~% ) : DefaultParser:DefaultParser * literal:char -&gt; Parser&lt;char,&#39;a0&gt;<br />&#160;&#160;static member ( %!!~~% ) : DefaultParser:DefaultParser * existing:Parser&lt;&#39;a,&#39;u&gt; -&gt; Parser&lt;&#39;a,&#39;u&gt;<br />&#160;&#160;static member ( %!!~~% ) : DefaultParser:DefaultParser * cap:Fitting&lt;&#39;a0,&#39;a1,&#39;a2&gt; -&gt; Fitting&lt;&#39;a0,&#39;a1,&#39;a2&gt; (requires &#39;a2 :&gt; Appendable)<br /><br />Full name: FParsec.Pipes.DefaultParsers.DefaultParser</div>
<div class="tip" id="fs35">val comma : Parser&lt;unit,unit&gt;</div>
<div class="tip" id="fs36">val spaces : Parser&lt;unit,&#39;u&gt;<br /><br />Full name: FParsec.CharParsers.spaces</div>
<div class="tip" id="fs37">val pipe3 : Parser&lt;&#39;a,&#39;u&gt; -&gt; Parser&lt;&#39;b,&#39;u&gt; -&gt; Parser&lt;&#39;c,&#39;u&gt; -&gt; (&#39;a -&gt; &#39;b -&gt; &#39;c -&gt; &#39;d) -&gt; Parser&lt;&#39;d,&#39;u&gt;<br /><br />Full name: FParsec.Primitives.pipe3</div>
<div class="tip" id="fs38">val x : float</div>
<div class="tip" id="fs39">val y : float</div>
<div class="tip" id="fs40">val z : float</div>
<div class="tip" id="fs41">val vector3pipe : Parser&lt;Vector3D,unit&gt;<br /><br />Full name: Intro.vector3pipe</div>
<div class="tip" id="fs42">val unitexample : Parser&lt;unit,unit&gt;<br /><br />Full name: Intro.unitexample</div>
<div class="tip" id="fs43">val constexample : Parser&lt;int,unit&gt;<br /><br />Full name: Intro.constexample</div>
<div class="tip" id="fs44">val auto1example : Parser&lt;int32,unit&gt;<br /><br />Full name: Intro.auto1example</div>
<div class="tip" id="fs45">val auto2example : Parser&lt;(float * int32),unit&gt;<br /><br />Full name: Intro.auto2example</div>
<div class="tip" id="fs46">type Timestamp =<br />&#160;&#160;| UnixTimestamp of int64<br />&#160;&#160;| CalendarTimestamp of DateTime<br /><br />Full name: Intro.Timestamp</div>
<div class="tip" id="fs47">union case Timestamp.UnixTimestamp: int64 -&gt; Timestamp</div>
<div class="tip" id="fs48">Multiple items<br />val int64 : value:&#39;T -&gt; int64 (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int64<br /><br />--------------------<br />type int64 = Int64<br /><br />Full name: Microsoft.FSharp.Core.int64<br /><br />--------------------<br />type int64&lt;&#39;Measure&gt; = int64<br /><br />Full name: Microsoft.FSharp.Core.int64&lt;_&gt;</div>
<div class="tip" id="fs49">union case Timestamp.CalendarTimestamp: DateTime -&gt; Timestamp</div>
<div class="tip" id="fs50">val unixTimestamp : Parser&lt;Timestamp,unit&gt;<br /><br />Full name: Intro.unixTimestamp</div>
<div class="tip" id="fs51">val calendarTimestamp : Parser&lt;Timestamp,unit&gt;<br /><br />Full name: Intro.calendarTimestamp</div>
<div class="tip" id="fs52">val timestamp : Parser&lt;Timestamp,unit&gt;<br /><br />Full name: Intro.timestamp</div>
<div class="tip" id="fs53">val calendarTimestampBacktrack1 : Parser&lt;obj,unit&gt;<br /><br />Full name: Intro.calendarTimestampBacktrack1</div>
<div class="tip" id="fs54">val calendarTimestampBacktrack2 : Parser&lt;obj,unit&gt;<br /><br />Full name: Intro.calendarTimestampBacktrack2</div>
<div class="tip" id="fs55">val qty : RangeDefiner<br /><br />Full name: FParsec.Pipes.Many.qty</div>
<div class="tip" id="fs56">val comma : unit -&gt; Parser&lt;unit,&#39;a&gt;<br /><br />Full name: Intro.comma</div>
<div class="tip" id="fs57">val element : unit -&gt; Parser&lt;unit,&#39;a&gt;<br /><br />Full name: Intro.element</div>
          
        </div>
        <div class="span3">

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">FParsec-Pipes</li>
            <li><a href="Intro.html">Intro</a></li>
            <li><a href="Reference.html">Reference</a></li>
            <!--

              Here you can add links to other pages of the documentation 
              The 'divider' element creates a separator and additional
              'nav-header' can be used to add sub-headings in the menu:

              * <li class="divider"></li>
              * <li><a href="...">...</a></li>
              * <li class="nav-header">Sub-heading</li>

            -->
          </ul>
        </div>
      </div>
    </div>
    <a href="https://github.com/rspeele/FParsec-Pipes"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
  </body>
</html>